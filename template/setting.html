{template 'common/header'}
<ol class="nav nav-tabs">
  <li class="active"><a>系统设置</a></li>
  
</ol>
<div class="panel panel-default">
  <div class="panel-heading"><p>腾讯云配置</p>
   <p>启用腾讯云cos对象存储后，请把/attachment目录（不包括此目录）下的子文件及子目录上传至腾讯云存储, 相关工具：<a target="_blank" href="https://console.qcloud.com/cos/bucket" class="product-grey-font" >腾讯云存储</a></p>
 
  </div>
  <div class="panel-body">
    <form action="" method="post" class="form-horizontal form" id="form">
	<div class="form-group">
		<label class="col-xs-12 col-sm-3 col-md-2 control-label">APPID</label>
		<div class="col-sm-9 col-xs-12">
			<input type="text" name="cos[appid]" class="form-control" value="{$settings['cos']['appid']}" placeholder="" />
			<span class="help-block">APPID 是您项目的唯一ID</span>
		</div>
	</div>
	<div class="form-group">
		<label class="col-xs-12 col-sm-3 col-md-2 control-label">SecretID</label>
		<div class="col-sm-9 col-xs-12">
			<input type="text" name="cos[secretid]" class="form-control" value="{$settings['cos']['secretid']}" placeholder="" />
			<span class="help-block">SecretID 是您项目的安全秘钥，具有该账户完全的权限，请妥善保管</span>
		</div>
	</div>
	<div class="form-group">
		<label class="col-xs-12 col-sm-3 col-md-2 control-label">SecretKEY</label>
		<div class="col-sm-9 col-xs-12">
			<input type="text" name="cos[secretkey]" class="form-control encrypt" value="{$settings['cos']['secretkey']}" placeholder="" />
			<span class="help-block">SecretKEY 是您项目的安全秘钥，具有该账户完全的权限，请妥善保管</span>
		</div>
	</div>
	<div class="form-group" id="cosbucket">
		<label class="col-xs-12 col-sm-3 col-md-2 control-label">Bucket</label>
		<div class="col-sm-9 col-xs-12">
			<input type="text" name="cos[bucket]" class="form-control" value="{$settings['cos']['bucket']}" placeholder="" />
			<span class="help-block">请保证bucket为可公共读取的</span>
		</div>
	</div>
	<div class="form-group" >
		<label class="col-xs-12 col-sm-3 col-md-2 control-label">Url</label>
		<div class="col-sm-9 col-xs-12">
			<input type="text" name="cos[url]" class="form-control" value="{$settings['cos']['url']}" placeholder="" />
			<span class="help-block">腾讯云支持用户自定义访问域名。注：url开头加http://或https://结尾不加 ‘/’例：http://abc.com</span>
		</div>
	</div>
	<div class="form-group">
		<label class="col-xs-12 col-sm-3 col-md-2 control-label"></label>
		<div class="col-sm-9 col-xs-12">
			<button name="submit" class="btn btn-primary" value="submit">保存配置</button>
			<button name="button" type="button" class="btn btn-info js-checkremotecos" value="check">测试配置（无需保存）</button>
			<input type="hidden" name="token" value="{$_W['token']}" />
		</div>
	</div>
	</div>
 

</form>
</div>
 

<div class="panel panel-default">
	<div class="panel-heading">
	<p>支付设置</p>
	</div>
	<div class="panel-body">
	
	</div>

</div>


<script type="text/javascript">
	$(function() {
			$('.js-checkremotecos').on('click', function(){
			var appid = $.trim($(':text[name="cos[appid]"]').val());
			if (appid == '') {
				util.message('请填写APPID');
				return false;
			}
			var secretid = $.trim($(':text[name="cos[secretid]"]').val());
			if (secretid == '') {
				util.message('请填写secretid');
				return false;
			}
			var secretkey = $.trim($(':text[name="cos[secretkey]"]').val());
			if (secretkey == '') {
				util.message('请填写Secretkey');
				return false;
			}
			var bucket = $.trim($(':text[name="cos[bucket]"]').val());
			if (bucket == '') {
				util.message('请填写bucket');
				return false;
			}
			var url = $.trim($(':text[name="cos[url]"]').val());
			if (url == '') {
				util.message('请填写url');
				return false;
			}
			var param = {
				'appid' : appid,
				'secretid' : secretid,
				'secretkey'  : secretkey,
				'bucket' :  bucket,
				'url' : url
			}; 
			posturl = "./index.php?c=utility&a=checkattach&do=cos&";
			
			$.post("./index.php?c=utility&a=checkattach&do=cos&",param, function(data) {
				var data = $.parseJSON(data);alert(data);
				if(data.message.errno == 0) {
					util.message('配置成功');
					return false;
				}
				if(data.message.errno < 0) {
					util.message(data.message.message);
					return false;
				}
			});
		});
	
	
	});
		 
</script>
 
{template 'common/footer'}
